# Using bwa to align reads to the C elegans reference genome
# assembly.fasta file has to be indexed first 

bwa index -p bwaindex assembly.fasta     # running this command generated 5 files bwaindex.amb, bwaindex.ann, bwaindex.bwt, bwaindex.pac, bwaindex.sa

bwa mem bwaindex GSF3874-AM-A5-M1_S1_R1_001.fastq > M1aln.sam     # aligning reads to reference genome 

samtools sort M1aln.sam -o M1aln.sorted.sam           # sorting the sam file 

samtools view -Sb -o M1aln.bam M1aln.sorted.sam          # converting sam output to bam file 

samtools index M1aln.bam                                 # For this command to work, sam file had to be sorted first 

bcftools mpileup -f assembly.fasta M1aln.bam > M1.vcf


